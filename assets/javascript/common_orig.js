"use strict";var App={initialize:function(){var a=$('a[rel="javascript"]');if(a.length){a.removeAttr("onclick").removeAttr("onmouseover").removeAttr("title").css("cursor","pointer");}var e=$("#support-link"),d=$("#explore-link"),c=$("#breaking-link"),b=$("#auth-link");if(e.length>0){e.unbind().click(function(){Tickets.loadStatus();Toggle.open(this,"active","#support-menu");return false;});}if(b.length>0){b.unbind().click(function(){Marketing.trackImpression("Battle.net Authenticator","Menu Toggle",$("#auth-menu").is(":hidden")?"Open":"Close");Toggle.open(this,"active","#auth-menu");return false;});$("#auth-menu a").click(function(){var f;if(this.className==="auth-close"){Toggle.open(b,"active","#auth-menu");b.parent().hide();f="Close";}else{if(this.className==="auth-button"){f="Add";}else{f="More";}}Marketing.trackImpression("Battle.net Authenticator","Link Click",f);Cookie.create("serviceBar.authCheck",1,{expires:744,path:"/"});});Marketing.trackImpression("Battle.net Authenticator","Impression","Impression");}if(d.length>0){d.unbind().click(function(){Toggle.open(this,"active","#explore-menu");return false;});}if(c.length>0){c.unbind().click(function(){App.breakingNews();return false;});}},closeWarning:function(b,a){$(b).hide();if(a){App.saveCookie(a);}},breakingNews:function(c){var b=$("#breaking-news");var a=$("#announcement-warning");if(a.is(":visible")){a.hide();b.removeClass("opened");}else{a.show();b.addClass("opened");}if(c){Cookie.create("serviceBar.breakingNews",c);}},saveCookie:function(a){Cookie.create("serviceBar."+a,1,{expires:8760,path:"/"});},resetCookie:function(a){Cookie.create("serviceBar."+a,0,{expires:8760,path:"/"});},serviceBar:function(){var b=Cookie.read("serviceBar.browserWarning");var a=Cookie.read("serviceBar.localeWarning");if(b===1){$("#browser-warning").hide();}if(a===1){$("#i18n-warning").hide();}},totalModules:0,totalLoaded:0,modules:[],forceLoad:true,sidebar:function(a){App.totalModules=a.length;if(a.length){for(var b=0;b<=(a.length-1);++b){App.loadModule(a[b],b);}}window.setTimeout(function(){if(App.forceLoad){App.showSidebar();}},5000);},showSidebar:function(){App.forceLoad=false;var a=$("#dynamic-sidebar-target");var c=$("#sidebar .sidebar-bot");for(var b=0;b<App.totalModules;b++){if(App.modules[b]){App.modules[b].appendTo(a);}}$("#sidebar-loading").fadeOut("normal",function(){c.find(".sidebar-module").fadeIn();$(this).remove();});App.modules=[];App.totalModules=0;App.totalLoaded=0;},loadModule:function(c,b){var a=$("#dynamic-sidebar-target");$.ajax({url:Core.baseUrl+"/sidebar/"+c.type+(c.query||""),type:"GET",dataType:"html",cache:true,global:false,success:function(e){App.totalLoaded++;if($.trim(e)!==""){var d=$(e);if(App.forceLoad){d.hide();App.modules[b]=d;}else{d.appendTo(a);}}},error:function(){App.totalLoaded++;},complete:function(){if(App.totalLoaded>=App.totalModules){window.setTimeout(App.showSidebar,100);}}});}};$(function(){App.initialize();});var Blackout={initialized:false,element:null,shim:null,initialize:function(){Blackout.element=$("<div/>",{id:"blackout"});Blackout.element.on("click",Core.stopPropagation).on("keyup",Blackout.listen);$("body").append(Blackout.element);if(Core.browser.full==="ie6"){Blackout.element.css("backgroundColor","#000");Blackout.element.css("filter","alpha(opacity=70)");Blackout.shim=$("<iframe />",{src:"javascript:false;",frameborder:0,scrolling:"no"}).addClass("support-shim");Blackout.element.append(Blackout.shim);}Blackout.initialized=true;},listen:function(a){if(a.which===KeyCode.esc){Blackout.hide();}},show:function(c,b,a){if(!Blackout.initialized){Blackout.initialize();}if(Core.isIE()){Blackout.element.css("width",Page.dimensions.width).css("height",$(document).height());if(Core.browser.full==="ie6"){Blackout.shim.css("width",Blackout.element.css("width")).css("height",Blackout.element.css("height"));if(Core.isCallback(b)){Blackout.shim[0].contentWindow.document.onclick=b;}}}if(a){Blackout.element.addClass("blackout-transparent");}Blackout.element.show();if(Core.isCallback(c)){c();}if(Core.isCallback(b)){Blackout.element.click(b);}},hide:function(a){Blackout.element.hide();if(Core.isCallback(a)){a();}Blackout.element.unbind("click").removeClass("blackout-transparent");}};if(!Object.create){Object.create=function(b){if(arguments.length>1){throw new Error("Object.create implementation only accepts the first parameter.");}function a(){}a.prototype=b;return new a();};}if(!Object.getPrototypeOf){if(typeof"test".__proto__==="object"){Object.getPrototypeOf=function(a){return a.__proto__;};}else{Object.getPrototypeOf=function(a){return a.constructor.prototype;};}}if(!String.fromCodePoint){
/*!
	* ES6 Unicode Shims 0.1
	* (c) 2012 Steven Levithan <http://slevithan.com/>
	* MIT License
	*/
String.fromCodePoint=function fromCodePoint(){var d=[],a,e,b,c;for(c=0;c<arguments.length;++c){a=arguments[c];e=a-65536;b=a>65535?[55296+(e>>10),56320+(e&1023)]:[a];d.push(String.fromCharCode.apply(null,b));}return d.join("");};}if(!String.prototype.trim){String.prototype.trim=function(){return $.trim(this);};}if(!String.prototype.capitalize){String.prototype.capitalize=function(){return this.charAt(0).toUpperCase()+this.slice(1);};}jQuery.expr[":"].caseInsensitiveContains=typeof(jQuery.expr.createPseudo)=="function"?jQuery.expr.createPseudo(function(a){return function(b){return jQuery(b).text().toLocaleLowerCase().indexOf(a.toLocaleLowerCase())>=0;};}):function(c,b,a){return jQuery(c).text().toLocaleLowerCase().indexOf(a[3].toLocaleLowerCase())>=0;};jQuery.expr[":"].caseInsensitiveStartsWith=typeof(jQuery.expr.createPseudo)=="function"?jQuery.expr.createPseudo(function(a){return function(b){return jQuery(b).text().toLocaleLowerCase().indexOf(a.toLocaleLowerCase())===0;};}):function(c,b,a){return jQuery(c).text().toLocaleLowerCase().indexOf(a[3].toLocaleLowerCase())===0;};if(!jQuery.Event.prototype.stop){jQuery.Event.prototype.stop=function(){this.preventDefault();this.stopPropagation();};}$.ajaxSetup({error:function(a){if(a.readyState!==4){return false;}if(a.getResponseHeader("X-App")==="login"){Login.openOrRedirect();return false;}if(a.status){switch(a.status){case 301:case 302:case 307:case 403:case 404:case 500:case 503:return false;break;}}return true;},statusCode:{403:function(){Login.openOrRedirect();}}});var CharSelect={textareaContent:"",beforeCallback:null,afterCallback:null,initialize:function(){$(document).on("click","a.context-link",CharSelect.toggle);$("input.character-filter").on({blur:function(){Toggle.keepOpen=false;},keydown:function(a){if(a.which===KeyCode.enter){a.stopPropagation();a.preventDefault();}},keyup:CharSelect.filter});Input.bind(".character-filter");},pin:function(a,b){Tooltip.hide();$("div.character-list").html("").addClass("loading-chars");$.ajax({type:"POST",url:Core.baseUrl+"/pref/character",data:{index:a,xstoken:Cookie.read("xstoken")},global:false,success:function(c){if(Core.isIE()){location.reload(true);}if(Core.isCallback(CharSelect.beforeCallback)&&CharSelect.beforeCallback(b)){return;}CharSelect.updateComments(c);CharSelect.update();}});},update:function(){$.ajax({url:location.href,cache:false,global:false,error:function(){location.reload(true);},success:function(a){var b=$(typeof a==="string"?a:a.documentElement);$(".ajax-update").each(function(){var d=$(this),e;if(d.attr("id")){e="#"+d.attr("id");}else{e=d.attr("class").replace("ajax-update","").trim();e="."+e.split(" ")[0];}var f=b.find(e+".ajax-update").clone(),c=d.find("textarea");if(c.length&&c.val().length){CharSelect.textareaContent=c.val();}if(f.length){d.replaceWith(f);}});if(Core.isCallback(CharSelect.afterCallback)){CharSelect.afterCallback();}}});},updateComments:function(a){var b=$(typeof a==="string"?a:a.documentElement);var d=$("#comments");if(d.length){var c=$(".comments-form",$("#comments"));$(".character-info",c).each(function(){var e=b.find(".character-info").clone();$(this).replaceWith(e);});$(".avatar-outer a",c).each(function(){var e=b.find(".portrait-b .avatar-interior a").clone();$(this).replaceWith(e);});if(typeof Comments!=="undefined"){$(".character-info",Comments.replyForm).each(function(){$(this).replaceWith(b.find(".character-info").clone());});$(".avatar-outer a",Comments.replyForm).each(function(){$(this).replaceWith(b.find(".portrait-b .avatar-interior a").clone());});}}},toggle:function(a){a.stop();Toggle.open(a.currentTarget,"context-open",$(a.currentTarget).siblings(".ui-context"));return false;},close:function(a){$(a).parents(".ui-context").hide().siblings(".context-link").removeClass("context-open");return false;},swipe:function(e,d){var b=$(d).parents(".chars-pane"),c=(e=="in")?"left":"right",a=(e=="in")?"right":"left";b.hide("slide",{direction:c},150,function(){b.siblings(".chars-pane").show("slide",{direction:a},150,function(){var f=$(this).find(".scrollbar-wrapper");if(f.length>0){f.tinyscrollbar();}});});},filter:function(d){d.stop();Toggle.keepOpen=true;if(d.keyCode==KeyCode.enter){return;}var c=$(d.srcElement||d.currentTarget),g=c.val().toLowerCase(),f=c.parents(".chars-pane").find(".overview");if(d.keyCode==KeyCode.esc){c.val("");}if(c.val().length<1){f.children("a").removeClass("filtered");}else{f.children("a").each(function(){$(this)[($(this).text().toLowerCase().indexOf(g)>-1)?"removeClass":"addClass"]("filtered");});var b=f.children("a.filtered").length>=f.children("a").length;f.children(".no-results")[(b)?"show":"hide"]();}var a=c.parents(".chars-pane:first").find(".scrollbar-wrapper");if(a.length>0){a.tinyscrollbar();}}};$(function(){CharSelect.initialize();});var Cookie={cache:{},create:function(d,e,b){b=$.extend({},b);b.expires=b.expires||1;if(typeof b.expires==="number"){var a=b.expires;b.expires=new Date();b.expires.setTime(b.expires.getTime()+(a*3600000));}var c=[encodeURIComponent(d)+"=",b.escape?encodeURIComponent(e):e,b.expires?"; expires="+b.expires.toUTCString():"",b.path?"; path="+b.path:"",b.domain?"; domain="+b.domain:"",b.secure?"; secure":""];document.cookie=c.join("");if(Cookie.cache){if(b.expires.getTime()<(new Date()).getTime()){delete Cookie.cache[d];}else{Cookie.cache[d]=e;}}},read:function(c){if(Cookie.cache[c]){return Cookie.cache[c];}var a={};var d=document.cookie.split(";");if(d.length>0){for(var b=0;b<d.length;b++){var e=d[b].split("=");if(e.length>=2){a[$.trim(e[0])]=e[1];}}}Cookie.cache=a;return a[c]||null;},erase:function(b,a){if(!a){a={expires:-1};}else{if(!a.expires){a.expires=-1;}}Cookie.create(b,0,a);},isSupported:function(){return(document.cookie.indexOf("=")!==-1);}};var Core={baseUrl:"/",supportUrl:"/support/",browser:null,deferredLoadQueue:[],locale:"en-us",region:"us",shortDateFormat:"MM/dd/Y",dateTimeFormat:"dd/MM/yyyy HH:mm",project:"",staticUrl:"/",sharedStaticUrl:"/local-common/",host:"",userAgent:"web",initialize:function(){Core.processLoadQueue();Core.ui();Core.host=location.protocol+"//"+(location.host||location.hostname);var b=$("html"),a=Core.getBrowser();if(a.name!==""){b.addClass(a.name).addClass(a.full);if(a.name==="ie"&&(a.version===6||a.version===7)){b.addClass("ie67");}}},alpha:function(a){return a.replace(/[^a-zA-Z]/gi,"");},appendFrame:function(b,d,a,c,e){if(typeof b==="undefined"){return;}if(typeof d==="undefined"){d=1;}if(typeof a==="undefined"){a=1;}if(typeof c==="undefined"){c=$("body");}if(Core.isIE()){c.append('<iframe src="'+b+'" width="'+d+'" height="'+a+'" scrolling="no" frameborder="0" allowTransparency="true"'+((typeof e!=="undefined")?' id="'+e+'"':"")+"></iframe>");}else{c.append('<object type="text/html" data="'+b+'" width="'+d+'" height="'+a+'"'+((typeof e!=="undefined")?' id="'+e+'"':"")+"></object>");}},escapeSelector:function(a){return typeof a==="string"?a.replace(/[^-\w]/g,"\\$&"):a;},fixTableHeaders:function(b,a){$(b).each(function(){a=a||18;var d=$(this);var c=a;d.find(".sort-link").each(function(){var e=$(this).height();if(e>c){c=e;}});if(c>a){d.find(".sort-link, .sort-tab").css("height",c);}});},formatLocale:function(c,a){a=a||"-";c=c||1;switch(c){case 1:default:return Core.locale.replace("-",a);break;case 2:var b=Core.locale.split("-");return b[0]+a+b[1].toUpperCase();break;case 3:return Core.locale.toUpperCase().replace("-",a);break;}},formatDatetime:function(d,f){var b;if(!f){b=new Date();}else{b=new Date(f);if(isNaN(b.getTime())){f=f.substring(0,10)+" "+f.substring(11,16)+":00 GMT"+f.substring(16,19)+f.substring(20,22);b=new Date(f);}if(isNaN(b.getTime())){f=f.substring(0,4)+"/"+f.substring(5,7)+"/"+f.substring(8,29);b=new Date(f);}if(isNaN(b.getTime())){f=f.substring(5,10)+" "+f.substring(11,16)+" GMT"+f.substring(23,28)+" "+f.substring(0,4);b=new Date(f);}if(isNaN(b.getTime())){return false;}}if(!d){d="yyyy-MM-ddThh:mmZ";}var c=b.getHours(),a="AM";if(c>12){c-=12;a="PM";}else{if(c===12){a="PM";}else{if(c===0){c=12;}}}var e=parseInt(b.getTimezoneOffset()/60*-1,10);if(e<0){e="-"+Core.zeroFill(Math.abs(e),2)+":00";}else{e=" + "+Core.zeroFill(Math.abs(e),2)+":00";}d=d.replace("yyyy",b.getFullYear());d=d.replace("MM",Core.zeroFill(b.getMonth()+1,2));d=d.replace("dd",Core.zeroFill(b.getDate(),2));d=d.replace("HH",Core.zeroFill(b.getHours(),2));d=d.replace("hh",Core.zeroFill(c,2));d=d.replace("mm",Core.zeroFill(b.getMinutes(),2));d=d.replace("a",a);d=d.replace("Z",e);return d;},getBrowser:function(){if(Core.browser){return Core.browser;}var c=$.support,b="",a=0;if(!c.hrefNormalized&&!c.tbody&&!c.style&&!c.opacity){if(typeof document.body.style.maxHeight!=="undefined"||window.XMLHttpRequest){b="ie";a=7;}else{b="ie";a=6;}}else{if(c.hrefNormalized&&c.tbody&&c.style&&!c.opacity){b="ie";a=8;}else{if(typeof $.browser!=="undefined"){if($.browser.mozilla){b="ff";}else{if($.browser.msie){b="ie";}else{if($.browser.webkit){if(navigator.userAgent.toLowerCase().indexOf("chrome")>=0){b="chrome";}else{b="safari";}}else{if($.browser.opera){b="opera";}}}}a=parseInt($.browser.version,10);}}}Core.browser={name:b,full:b+a,version:a};return Core.browser;},getHash:function(){var a=location.hash||"";return a.substr(1,a.length);},getLanguage:function(){return Core.locale.split("-")[0];},getRegion:function(){return Core.locale.split("-")[1];},goTo:function(a,b){window.location.href=(b?Core.baseUrl:"")+a;if(window.event){window.event.returnValue=false;}},include:function(b,c,a){$.ajax({url:b,dataType:"script",success:c,cache:a!==false});},isCallback:function(a){return(a&&typeof a==="function");},isIE:function(a){var b=Core.getBrowser();if(a){return(a===b.version);}return(b.name==="ie");},load:function(b,a,c){a=a!==false;if(Page.loaded||!a){Core.loadDeferred(b,c);}else{Core.deferredLoadQueue.push(b);}},loadDeferred:function(b,e){var d=b.indexOf("?");var c=b.lastIndexOf(".")+1;var a=b.substring(c,d===-1?b.length:d);switch(a){case"js":Core.loadDeferredScript(b,e);break;case"css":Core.loadDeferredStyle(b);break;}},loadDeferredScript:function(a,b){$.ajax({url:a,cache:true,global:false,dataType:"script",success:b});},loadDeferredStyle:function(b,a){$("head").append('<link rel="stylesheet" href="'+b+'" type="text/css" media="'+(a||"all")+'" />');},msg:function(c){for(var b=1,a=arguments.length;b<a;++b){c=c.replace("{"+(b-1)+"}",arguments[b]);}return c;},msgAll:function(c){for(var b=1,a=arguments.length;b<a;++b){c=c.replace(new RegExp("\\{"+(b-1)+"\\}","g"),arguments[b]);}return c;},numeric:function(a){a=a.replace(/[^0-9]/gi,"");if(!a||isNaN(a)){a=0;}return a;},open:function(a){if(a.href){window.open(a.href);}return false;},preventDefault:function(a){a.preventDefault();},processLoadQueue:function(){if(Core.deferredLoadQueue.length>0){for(var a=0,b;b=Core.deferredLoadQueue[a];a++){Core.load(b);}}},randomNumber:function(a){return Math.floor(Math.random()*a);},scrollTo:function(f,e,g){f=$(f);if(f.length!==1){return;}var d=$(window),a=d.scrollTop(),b=a+d.height(),c=f.offset().top;c-=15;if(c>=a&&c<=b){return;}if(typeof $.browser!=="undefined"){$($.browser.webkit?"body":"html").animate({scrollTop:c},e||350,g||null);}},scrollToVisible:function(g,f,h){g=$(g);if(g.length!==1){return;}var e=$(window),a=e.scrollTop(),c=a+e.height(),d=g.offset().top,b=d+g.height();d-=15;b+=15;if(d>=a&&b<=c){return;}if(typeof $.browser!=="undefined"){$($.browser.webkit?"body":"html").animate({scrollTop:(d<a?d:b-e.height())},f||350,h||null);}},stopEvent:function(a){a.stop();},stopPropagation:function(a){a.stopPropagation();},trimChar:function(a,b){if(a.substr(0,1)===b){a=a.substr(1,(a.length-1));}if(a.substr((a.length-1),a.length)===b){a=a.substr(0,(a.length-1));}return a;},trimRight:function(a,b){b=!b?" \\s\u00A0":(b+"").replace(/([\[\]\(\)\.\?\/\*\{\}\+\$\^\:])/g,"\\$1");return(a+"").replace(new RegExp("["+b+"]+$","g"),"");},ui:function(a){a=a||document;if(Core.isIE(6)){$(a).find("button.ui-button").hover(function(){if(!this.disabled||this.className.indexOf("disabled")==-1){$(this).addClass("hover");}},function(){$(this).removeClass("hover");});}if(Core.project!=="bam"){$(a).find("button.ui-button").click(function(d){var b=$(this);var c=b.attr("data-text");if(typeof c==="undefined"){c="";}if(this.tagName.toLowerCase()==="button"&&c!==""){if(b.attr("type")==="submit"){d.preventDefault();d.stopPropagation();b.find("span span").html(c);b.removeClass("hover").addClass("processing").attr("disabled","disabled");b.parents("form").submit();}}return true;});}},zeroFill:function(g,e,d){if(typeof d==="undefined"){d=false;}var a=parseFloat(g),b=false,f=e-a.toString().length,c=f-1;if(a<0){a=Math.abs(a);b=true;f++;c=f-1;}if(e>0){if(a.toString().indexOf(".")>0){if(!d){f+=a.toString().split(".")[1].length;}f++;c=f-1;}if(c>=0){do{a="0"+a;}while(c--);}}if(b){return"-"+a;}return a;},trackEvent:function(a,c,b){window._gaq=_gaq||[];_gaq.push(["_trackEvent",a,c,b]);},bindTrackEvent:function(a,b,d,c){$(a).on("click.analytics",function(){var g=$(this);var h,i,f;if(typeof b=="function"){h=b.call(this);}else{h=b;}if(typeof c=="function"){f=c.call(this);}else{f=c;}if(typeof d=="function"){var e=g.data("action-attachment")||"Unknown Action";i=d.call(this,e);}else{i=d;}h=g.data("category")||h||Core.project;i=g.data("action")||i||"Click";f=g.data("label")||f||Core.locale;Core.trackEvent(h,i,f);});},showUntilClosed:function(e,h,i){i=i||{};var d=$(e),b="bnet.closed."+h;if(!d.length||!Cookie.isSupported()||Cookie.read(b)){return false;}var a=new Date();if(i.startDate){var c=new Date(i.startDate);if((c-a)>0){return false;}}if(i.endDate){var f=new Date(i.endDate);if((f-a)<0){return false;}}if(i.fadeIn){d.fadeIn(i.fadeIn,i.onShow);}else{d.show();if(i.onShow){i.onShow();}}var g=$.extend({path:Core.baseUrl,expires:8760},i.cookieParams||{});d.delegate("a","click",function(){var k=$(this),l=k.data("label"),j=(this.rel==="close");if(j){d.hide();if(i.onHide){i.onHide();}}if(j||!i.closeButtonOnly){Cookie.create(b,1,g);}if(l){Marketing.trackImpression(i.trackingCategory||"Tracking",i.trackingAction||"Click",l);}});return true;}};$(function(){Core.initialize();});var Feedback={form:null,ID_MAP:{url:"feedback-page-url",email:"feedback-email",subject:"feedback-subject",body:"feedback-body"},overlayInstance:null,pageErrorMsg:"",pageReferring:"",feedbackUrl:"",initialize:function(){if($("#feedback-page").length){return;}this.feedbackUrl="/"+Core.locale+"/feedback/";var c=$(".feedback-suggestion-open"),b=$(".feedback-error-open"),a=this;c.each(function(){this.onclick=function(){a.open("suggestion");return false;};});b.each(function(){this.onclick=function(){a.open("bug");return false;};});this.overlayInstance=Overlay;},open:function(b){var a=this;a.overlayInstance.open(a.feedbackUrl+"feedback-form.frag",{ajax:true,className:"feedback-overlay",bindClose:false});$("#overlay").unbind("overlayLoaded");$("#overlay").bind("overlayLoaded",function(){var f=$(a.overlayInstance.wrapper);a.overlayInstance.position();f.css("position","absolute");if(parseInt(f.css("top"),10)<0){f.css("top",0);}a.form=document.getElementById("website-feedback");var l=$(".feedback-wrapper h2"),d=$("#feedback-intro-message"),h=document.getElementById("feedback-submit"),e=document.getElementById("feedback-subject"),n=document.getElementById("feedback-page-url"),k=document.getElementById("page-url-system"),g=$(".feedback-body-label #body-label-text"),j=document.getElementById("feedback-body"),c=document.getElementById("feedback-body-char-count"),m=$(c),i=j.getAttribute("maxlength");$(".overlay-close").unbind("click").bind("click",function(o){o.preventDefault();a.cancel();});if(b==="suggestion"){l.html(Feedback.titleWebsiteSuggestion);d.html(Feedback.introFeedback);}else{l.html(Feedback.titleWebsiteFeedback);d.html(Feedback.introError);g.html(Feedback.feedbackError);}a.form.setAttribute("action",a.feedbackUrl+b);e.value=a.pageErrorMsg;n.value=a.pageReferring;k.value=a.pageReferring;$(n).focus();$("#blackout").bind("click.feedback",function(o){$(n).focus();});$(n).keydown(function(o){if(o.which===9&&o.shiftKey){o.preventDefault();$(cancelBtn).focus();}});h.onclick=function(){if(!a.submit()){return false;}};c.parentNode.style.display="block";c.firstChild.nodeValue=i;j.onkeyup=function(){if(this.value.length>i){$(this).addClass(".feedback-error");m.addClass("error");}else{m.removeClass("error");}m.html(i-this.value.length);};});},submit:function(){var c=this.form.getAttribute("action"),j=document.getElementById("feedback-email"),a=document.getElementById("feedback-body-char-count"),g=document.getElementById("feedback-body"),b=$("#feedback-intro-message"),k=this;$(".feedback-error").each(function(){var i=$(this);i.removeClass("feedback-error");if(i.attr("id")!=="feedback-body-char-count"){i.next(".feedback-error-msg").hide();}$(a).removeClass("error");});if(g.value.length>(g.hasAttribute("maxlength")?g.getAttribute("maxlength"):2000)){$(g).addClass("feedback-error");$(a).addClass("error");}var f=$(".feedback-required",this.form);f.each(function(){var i=$(this);if((i.val()===null)||($.trim(i.val())==="")){i.addClass("feedback-error");i.next(".feedback-error-msg").show();}});if($(".feedback-error").length===0){var h=$(k.form).serializeArray();if($.trim(j.value)===""){for(var e=0,d=h.length;e<d;e+=1){if(h[e].name==="email"){h[e].value="no_email_given@blizzard.com";}}}$.ajax({type:"POST",url:c,data:h,success:function(){var i=document.getElementById("feedback-success"),l=document.getElementById("feedback-close");k.form.style.display="none";i.style.display="block";b.hide();l.onclick=function(){k.cancel();};},error:function(m){var i;try{i=JSON.parse(m.responseText);if(i){$.each(i.fieldErrors,function(p,q){$("#"+k.ID_MAP[p]).addClass("feedback-error").next(".feedback-error-msg").show();});return false;}else{throw"Invalid response";}}catch(n){var o=document.getElementById("feedback-fail"),l=document.getElementById("feedback-fail-close");k.form.style.display="none";o.style.display="block";l.onclick=function(){k.cancel();};return false;}}});return false;}else{}},cancel:function(){$(".feedback-wrapper").remove();$("#blackout").unbind("click.feedback");this.overlayInstance.close();this.overlayInstance.cache={};return false;}};var Filter={query:{},timers:{},initialize:function(g){var c=0;if(location.hash){var e=Core.getHash();if(e!=="reset"){var f=e.split("&"),d;for(var a=0,b=f.length;a<b;++a){d=f[a].split("=");Filter.query[d[0]]=decodeURIComponent(d[1])||"null";c++;}}}Filter.uiSetup(true);if(Core.isCallback(g)){g(Filter.query,c);}},addParam:function(a,b){if(a){if(!b||b===""){Filter.deleteParam(a);}else{Filter.query[a]=b;}}},appendRangeData:function(b,c){var a={};if(typeof b.data("min")!=="undefined"){a={min:parseInt(c,10),max:parseInt(b.siblings("input[data-max]").val(),10),base:b.data("min"),type:"min"};}else{a={min:parseInt(b.siblings("input[data-min]").val(),10),max:parseInt(c,10),base:b.data("max"),type:"max"};}return a;},applyQuery:function(){var b=[];if(Filter.query){for(var a in Filter.query){if(Filter.query[a]!==null&&Filter.query.hasOwnProperty(a)){b.push(a+"="+encodeURIComponent(Filter.query[a]));}}}if(b.length>0){location.replace("#"+b.join("&"));}else{Filter.reset();}},bindInputs:function(a,b){$(a).find("[data-filter]").each(function(){var c=$(this),d=Filter.extractData(c);if(d.field==="text"||d.field==="textarea"){c.keyup(function(){d.value=c.val();if(d.filter==="range"){d.range=Filter.appendRangeData(c,d.value);}Filter.setTimer(d.name,d,b);});}else{if(d.field==="a"){c.click(function(){d.value=c.data("value");b(d);});}else{c.change(function(){var e=(typeof c.data("value")!=="undefined")?c.data("value"):"";if(d.field==="checkbox"){d.value=c.is(":checked")?(e||"true"):"";}else{d.value=e||c.val();}b(d);});}}});},defaultApply:function(b,a){if(a>0){$.each(b,function(d,e){var c=$("#filter-"+d);if(!c.length){return;}if(c.is(":checkbox")&&e==="true"){c.prop("checked",true);}else{c.val(e);}});}},deleteParam:function(a){Filter.query[a]=null;},extractData:function(a){var b=$(a),c=b.prop("nodeName").toLowerCase();return{tag:c,node:b,name:(typeof b.data("name")!=="undefined")?b.data("name"):b.attr("id").replace("filter-",""),filter:b.data("filter"),column:b.data("column"),field:(c==="input")?b.attr("type"):c,value:""};},getParam:function(a){return Filter.query[a]||null;},reset:function(){Filter.query={};Filter.timers={};location.replace("#reset");},resetInputs:function(a){if(!a){return;}$(a).find("input, select, textarea").each(function(){var b=$(this),c;if((c=b.data("min"))!=="undefined"){b.val(c);}else{if((c=b.data("max"))!=="undefined"){b.val(c);}else{if((c=b.data("default"))!=="undefined"){b.val(c);}else{b.val("");}}}b.removeClass("active").removeAttr("checked");if(this.tagName.toLowerCase()==="input"&&(this.type==="checkbox"||this.type==="radio")){this.checked=false;}});},setTimer:function(a,b,c){if(Filter.timers[a]!==null){window.clearTimeout(Filter.timers[a]);Filter.timers[a]=null;}Filter.timers[a]=window.setTimeout(function(){c(b);},350);},applyReset:false,uiClick:function(d){var b=$(d.currentTarget||d.target),a=b.siblings(".view"),c=b.siblings(".reset");if(b.val()!==""){a.hide();c.show();}else{a.show();c.hide();}},uiReset:function(f){var c=$(f.currentTarget||f.target),a=c.siblings(".view"),b=c.siblings(".input");a.show();c.hide();b.trigger("reset");if(Filter.applyReset){var d=Filter.extractData(b);Filter.deleteParam(d.name);Filter.applyQuery();}},uiSetup:function(a){var b=$(".ui-filter");if(b.length){b.find(".reset").click(Filter.uiReset);b.find(".input").bind({keyup:Filter.uiClick,focus:Input.activate,blue:Input.reset,reset:function(){$(this).val("").trigger("keyup").trigger("blur");}});}Filter.applyReset=a;}};var Flash={videoPlayer:"",videoBase:"",ratingImage:"",expressInstall:"expressInstall.swf",requiredVersion:"10.2.154",initialize:function(){Flash.defaultVideoFlashVars.ratingPath=Flash.ratingImage;Flash.defaultVideoFlashVars.locale=Core.locale;Flash.defaultVideoFlashVars.dateFormat=Core.shortDateFormat;},defaultVideoParams:{allowFullScreen:"true",bgcolor:"#000000",allowScriptAccess:"always",wmode:"opaque",menu:"false"},defaultVideoFlashVars:{ratingFadeTime:"1",ratingShowTime:"4",autoPlay:true},getFlashError:function(){var a=$('<div id="flash-error" class="align-center" />');a.append('<h3 class="subheader">'+Msg.ui.flashErrorHeader+'</h3><p><a href="'+Msg.ui.flashErrorUrl+'">'+Msg.ui.flashErrorText+"</a></p>");return a;}};$(function(){Flash.initialize();});var Hash={base:"aZbYcXdWeVfUgThSiRjQkPlOmNnMoLpKqJrIsHtGuFvEwDxCyBzA0123456789+/",delimiter:"!",empty:".",batch:function(d){var b=[];for(var c=0,a=d.length;c<a;c++){b.push(Hash.encode(d[c]));}return Core.trimRight(b.join(Hash.delimiter),Hash.delimiter);},encode:function(f,e){var g="",d=Hash.base,c=Hash.empty;for(var b=0,a=f.length;b<a;b++){if(f[b]!==null){g+=d.charAt(f[b]);}else{if(e){g+=c;}}}return Core.trimRight(g,c);},decode:function(f){var g=[],e=Hash.base,d=Hash.empty;for(var c=0,a=f.length,b;c<a;c++){b=f.charAt(c);b=(b===d)?null:e.indexOf(b);g.push(b);}return g;}};var History={enabled:(window.history.pushState),hashbangs:{},log:[],hashChangeCallback:null,popStateCallback:null,initialize:function(){window.onhashchange=History.onHashChange;window.onpopstate=History.onPopState;},lookup:function(a){return History.log[a]||History.log;},flush:function(){History.log=[];},isHashbang:function(){return(Core.getHash().charAt(0)==="!");},push:function(b,a){b=History.packageState(b);History.log.push([b,a]);if(History.enabled){window.history.pushState(b,document.title,a);}else{History.updateHash(b,a);}},replace:function(b,a){b=History.packageState(b,true);History.log[History.log.length-1]=[b,a];if(History.enabled){window.history.replaceState(b,document.title,a);}else{History.updateHash(b,a);}},updateHash:function(b,a){if(a.indexOf("#")!==-1){a=a.split("#")[0];}if(a.charAt(0)!=="/"){a="/"+a;}a="!"+a.replace("?","");location.hash=a;History.hashbangs[a]=b;},packageState:function(a,b){if(b){a.logIndex=History.log.length;}else{a.logIndex=History.log.length+1;}a.replacedState=(b===true);a.pageTitle=document.title;a.currentHash=location.hash;a.absoluteUrl=location.href;a.isHashbang=!History.enabled;return a;},onHashChange:function(b){if(Core.isCallback(History.hashChangeCallback)){var a=History.hashbangs[Core.getHash()]||null;History.hashChangeCallback(b,a);}},onPopState:function(a){if(Core.isCallback(History.popStateCallback)){History.popStateCallback(a);}}};$(function(){History.initialize();});var Input={initialize:function(){Input.bind("#search-field");},bind:function(b){Input.reset(b);var a=$(b);a.focus(Input.activate).blur(Input.reset);a.closest("form").submit(function(){return Input.submit(a);});},activate:function(b){var a=(typeof b==="string")?$(b):$(this);if(!a.length){return;}if(a.val()===a.attr("alt")){a.val("");}a.addClass("active");},reset:function(b){var a=(typeof b==="string")?$(b):$(this);if(!a.length){return;}if(a.val()===""){a.removeClass("active").val(a.attr("alt"));}else{if(a.val()!==a.attr("alt")){a.addClass("active");}}},submit:function(a){a=$(a||this);if(a.val()===a.attr("alt")){a.val("");}return true;}};$(function(){Input.initialize();});var KeyCode={backspace:8,enter:13,esc:27,space:32,tab:9,arrowLeft:37,arrowUp:38,arrowRight:39,arrowDown:40,map:{global:{numbers:[48,49,50,51,52,53,54,55,56,57,96,97,98,99,100,101,102,103,104,105],letters:[65,66,67,68,69,70,71,72,73,74,75,76,77,78,79,80,81,82,83,84,85,86,87,88,89,90],controls:[8,9,13,16,17,18,20,27,33,32,34,35,36,45,46,144],functions:[112,113,114,115,116,117,118,119,120,121,122,123],arrows:[37,38,39,40],os:[17,91,92,93,219,224]},de:{letters:[59,192,219,222]},es:{letters:[59,192]},ru:{letters:[59,188,190,192,219,221,222]},fr:{letters:[191]}},arrows:function(a){return KeyCode.get("arrows",a);},controls:function(a){return KeyCode.get("controls",a);},functions:function(a){return KeyCode.get("functions",a);},get:function(e,g){g=g||Core.getLanguage();var f=[],d=[];if(typeof e==="string"){d=[e];}else{d=e;}for(var c=0,a=d.length;c<a;++c){var b=d[c];if(!KeyCode.map.global[b]){continue;}f=f.concat(KeyCode.map.global[b]);if(KeyCode.map[g]&&KeyCode.map[g][b]){f=f.concat(KeyCode.map[g][b]);}}return f;},isAlpha:function(a,b){return($.inArray(a.which,KeyCode.get(["letters","controls"],b))>=0);},isAlnum:function(a,b){return(KeyCode.isAlpha(a,b)||KeyCode.isNumeric(a,b));},isNumeric:function(a,b){return($.inArray(a.which,KeyCode.get(["numbers","controls"],b))>=0)&&!a.shiftKey;},letters:function(a){return KeyCode.get("letters",a);},numbers:function(a){return KeyCode.get("numbers",a);}};var Locale={dataPath:"data/i18n.frag",initialize:function(){var a=location.pathname.replace(Core.baseUrl,"");a=a+(location.search||"?");$("#change-language, #service .service-language a").click(function(){return Locale.openMenu("#change-language",encodeURIComponent(a));});},openMenu:function(b,c){var a=$("#international");b=$(b);c=c||"";if(a.is(":visible")){a.slideUp();b.toggleClass("open");}else{if(a.html()!==""){Locale.display();b.toggleClass("open");}else{$.ajax({url:Core.baseUrl+"/"+Locale.dataPath+"?path="+c,dataType:"html",success:function(d){if(d){a.replaceWith(d);b.toggleClass("open");Locale.display();}}});}}return false;},trackEvent:function(b,a){try{_gaq.push(["_trackEvent","Battle.net Language Change Event",b,a]);}catch(c){}},display:function(){var a=$("#international");a.slideDown("fast",function(){$(this).css("display","block");});if(typeof $.browser==="undefined"||!$.browser.opera){$("html, body").animate({scrollTop:a.offset().top},1000);}}};$(function(){Locale.initialize();});var Login={CONTAINER_ID:"login-embedded",FADE_DURATION:"slow",embeddedUrl:"/login/login.frag",success:function(a){$("<div/>",{id:"embedded-loader"}).appendTo("body");window.setTimeout(function(){var c=window.location.search?"&":"?";if(window.location.hash.length===0){window.location=window.location+c+"ST="+a;}else{var b=window.location.href.substring(0,window.location.href.length-window.location.hash.length);window.location=b+c+"ST="+a+"&ST-frag="+window.location.hash.substring(1);}},100);},open:function(c,b,d){c=c||Login.embeddedUrl;Login._timeTracker.start();var f=(c.indexOf("?")===-1)?"?":"&";if("https:"===document.location.protocol){c+=f;c+="secureOrigin=true";f="&";}if(c.indexOf("?loc=")===-1||c.indexOf("&loc=")===-1){c+=f+"loc="+Core.getLanguage();f="&";}if(c.indexOf("?ref=")===-1||c.indexOf("&ref=")===-1){c+=f+"ref="+encodeURIComponent(window.location);f="&";}if(document.getElementById(Login.CONTAINER_ID)){return false;}if((typeof postMessage!=="object"&&typeof postMessage!=="function")||typeof JSON!=="object"){if(b){var e=(d.indexOf("?")===-1)?"?":"&";document.location=b+encodeURIComponent(d+e+"ST-frag="+encodeURIComponent(Core.getHash()));return false;}return true;}var a=$("<div/>",{id:Login.CONTAINER_ID});a.append($("<iframe/>",{src:c,frameborder:0})).css("visibility","hidden");if(Core.isIE()){$(window).resize(function(){var g=$(document);$("#blackout").css({width:g.width(),height:g.height()});});}a.appendTo("body");Blackout.show(null,function(){Blackout.hide();Login._close();});Login._setListener();Login._timeoutHandler.activate();return false;},openOrRedirect:function(c,b,d){if(Login.open(c,b,d)){var a=location.href,e=(a.indexOf("?")===-1)?"?":"&";location.href=a+e+"login=true&cr=true";}},_close:function(a){Login._removeListener();a=a||false;$("#"+Login.CONTAINER_ID).fadeOut(Login.FADE_DURATION,function(){$(this).remove();if(a){Blackout.hide();}});Login._timeoutHandler.deactivate();},_messageListener:function(b){var c=JSON.parse(b.data);switch(c.action){case"onload":Login._timeoutHandler.deactivate();Login._timeTracker.end();var a=$("#"+Login.CONTAINER_ID),d=$("#"+Login.CONTAINER_ID+" iframe");a.css("height",c.height);d.css("height",c.height);if(c.height>500){a.css("margin-top",-(c.height/2));a.css("margin-bottom",-(c.height/2));}a.css("visibility","visible");break;case"success":Login._close();Login.success(c.loginTicket);break;case"close":Login._close(true);break;case"redirect":window.location=c.url+"?ref="+encodeURIComponent(window.location);break;}},_setListener:function(){Login._removeListener();Login._listener=function(a){Login._messageListener(a);};if(typeof addEventListener!=="undefined"){addEventListener("message",Login._listener,false);}else{attachEvent("onmessage",Login._listener);}},_removeListener:function(){if(!Login._listener){return;}if(typeof removeEventListener!=="undefined"){removeEventListener("message",Login._listener,false);}else{detachEvent("onmessage",Login._listener);}},_timeTracker:{startTime:null,start:function(){this.startTime=new Date().getTime();},end:function(){_gaq.push(["_trackEvent","debug","login frag load time",""+Math.round(((new Date().getTime())-this.startTime)/500)*500]);}},_timeoutHandler:{timeoutMs:5000,timeoutVar:null,loaderVar:null,activate:function(){this.loaderVar=$("<div/>",{id:"embedded-loader"}).appendTo("body");this.timeoutVar=window.setTimeout(function(){Login._timeoutHandler.handleTimeout();},this.timeoutMs);},deactivate:function(){this.loaderVar.remove();window.clearTimeout(this.timeoutVar);this.timeoutVar=null;},handleTimeout:function(){_gaq.push(["_trackEvent","debug","login frag timeout",""+this.timeoutMs]);window.location="/?login";}}};var Marketing={bindTracking:function(c,a,b){$(c).click(function(){var d=$(this);try{_gaq.push(["_trackEvent",d.data("category")||a,d.data("action")||b,d.data("ad")+" ["+Core.locale+"]"]);}catch(f){}});},trackActivity:function(b,a){try{_gaq.push(["_trackEvent","Battle.net User Activity",b,a+" ["+Core.locale+"]"]);}catch(c){}},trackAd:function(f,d,b,a){try{b=b?b+" - ":"";_gaq.push(["_trackEvent","Battle.net Ad Service",(a)?"Ad Click-Throughs":"Ad Impressions","Ad "+encodeURIComponent(d.replace(" ","_"))+" - "+b+Core.locale+" - "+f]);}catch(c){}},trackImpression:function(b,c,a){try{_gaq.push(["_trackEvent",b,c,a+" ["+Core.locale+"]"]);}catch(d){}}};var Menu={data:{},dataIndex:{},container:null,node:null,idName:"menu-tier",className:"flyout-menu",timer:null,timers:{},openTimer:null,children:{},config:{},initialize:function(b,a){Menu.config=$.extend({},{duration:750,dataUrl:{},colWidth:200,colMax:15},a);Menu.container=$("<div/>").attr("id","menu-container").appendTo("body");Menu.container.unbind().mouseleave(function(){Menu.timer=window.setTimeout(function(){Menu.hide();},Menu.config.duration);}).mouseenter(function(){window.clearTimeout(Menu.timer);});if(!b){return false;}Menu.load("base",b);$(".ui-breadcrumb li a").each(function(f,c){var e=$(c),d=e.attr("href").replace(Core.baseUrl,"");e.mouseover(function(){Menu.show(this,d);});});},hide:function(){window.clearTimeout(Menu.timer);window.clearTimeout(Menu.openTimer);Menu.container.find("div").hide();if(Menu.node){Menu.node.removeClass("opened");Menu.node=null;}},hideChild:function(a){if(!Menu.children[a]){return;}Menu.children[a].children("a:first, span:first").removeClass("opened").end().children("."+Menu.className).hide();},load:function(b,a){if(Menu.data[b]){return;}$.ajax({url:Core.baseUrl+a,dataType:"json",success:function(e){Menu.data[b]=e;Menu.dataIndex[b]={};Menu._populate(e,b);var d=$(".ui-breadcrumb li a"),c=d.length-1;d.each(function(j){var g=$(this),h=g.attr("href").replace(Core.baseUrl,""),f=Menu.dataIndex[b][h];if(f){if(f.children&&c===j){g.parent().addClass("children");}if(!f.children){g.parent().addClass("childless");}}});}});Menu.config.dataUrl[b]=a;},open:function(b,d,a){a=$.extend({},{set:"base"},a||{});Menu.node=$(b);var c=Menu.dataIndex[a.set][d]||null;if(c&&c.children){if($("#"+Menu._id(d,a.set)).is(":visible")){Menu.hide();}else{Menu._display(d,a);}}},show:function(b,c,a){a=$.extend({},{set:"base"},a||{});if(!Menu.dataIndex[a.set][c]){return;}if($("#"+Menu._id(c,a.set)).is(":visible")){return;}Menu.hide();Menu.node=$(b);Menu.openTimer=window.setTimeout(function(){Menu._display(c,a);},200);Menu.node.unbind("mouseleave mouseenter").mouseleave(function(){window.clearTimeout(Menu.openTimer);Menu.timer=window.setTimeout(function(){Menu.hide();},Menu.config.duration);}).mouseenter(function(){window.clearTimeout(Menu.timer);});},_build:function(c,e,a){var f=$("<div>").addClass(Menu.className),d=[];if(a){f.attr("id",a);}$.each(e.children,function(j,l){var h=(l.url)?"a":"span",g=$("<li/>"),k=$("<"+h+"/>",Menu._prepare(l)).appendTo(g);if(l.description){k.append('<span class="desc">'+l.description+"</span>");}if(l.parentClass){g.addClass(l.parentClass);}if(l.children){k.addClass("children").append('<span class="child-arrow"></span>');}g.hover(function(){Menu.hideChild(e.url);if(l.children){var m=$(this);m.children("a:first, span:first").addClass("opened");if(m.find("."+Menu.className).length===0){Menu._build(this,l,false);}Menu._position(m.children("."+Menu.className));Menu.children[e.url]=m;window.clearTimeout(Menu.timers[e.url]);}},function(){if(l.children){Menu.timers[e.url]=window.setTimeout(function(){Menu.hideChild(e.url);},Menu.config.duration);}});var i=Math.ceil((j+1)/Menu.config.colMax)-1;if(e.children.length<=(Menu.config.colMax+3)){i=0;}if(!d[i]){d[i]=$("<ul/>");}g.appendTo(d[i]);});for(var b=0;b<=(d.length-1);++b){$(d[b]).appendTo(f);}if(d.length>1){f.css("width",(d.length*Menu.config.colWidth));}f.appendTo(c);},_display:function(k,l){if(!Menu.dataIndex[l.set][k]){return;}var e=Menu.dataIndex[l.set][k],b=(l.center)||(l===true),d=Menu._id(k,l.set);if(e&&e.children){var f=$("#"+d);if(f.length>0){f.fadeIn("fast");}else{Menu._build(Menu.container,e,d);}Menu.node.addClass("opened");var g=Menu.node.parent().offset(),j=Menu.node.parent().width(),i=g.left,h=g.top+Menu.node.outerHeight(false),a={top:h+"px",position:"absolute",visibility:"visible",zIndex:"75"};if(b){var c=Math.round(j/2)-Math.round(Menu.config.colWidth/2);a.left=(i+c)+"px";}else{a.left=i+"px";}Menu.container.css(a).show();}},_id:function(a,c){var b=Menu.idName+"-"+c;if(Menu.dataIndex[c][a].id){b+=Menu.dataIndex[c][a].id;}return b;},_position:function(b){b.show();if(b.find("ul").length<=1){var d=b.offset(),c=b.outerWidth(false),a=d.left+c;if(a>=Page.dimensions.width){b.css("left",-c);}}},_populate:function(b,d){if(!Menu.dataIndex[d][b.url]){b.id=(b.url?b.url.replace(/[^\-a-zA-Z0-9\/]/ig,""):"");b.id=b.id.replace(/\//ig,"-");if(b.id.substr(-1)==="-"){b.id=b.id.substr(0,(b.id.length-1));}Menu.dataIndex[d][b.url]=b;}if(b.children){for(var a=0,c;c=b.children[a];a++){Menu._populate(c,d);}}},_prepare:function(c){var b=c.label||"",a={html:b.replace(/&/ig,"&amp;"),rel:"np"},d={};if(c.url!==null){a.href=Core.baseUrl+c.url;}$.each(a,function(e,f){if(f){d[e]=f;}});return d;}};var Overlay={cache:{},config:{ajax:false,bindClose:true,className:"",fadeSpeed:250,blackout:true},loaded:null,wrapper:null,initialize:function(){if(Overlay.loaded&&Overlay.wrapper){return;}Overlay.wrapper=$("<div/>",{id:"overlay","class":"ui-overlay"}).appendTo("body").hide();$("<a/>").addClass("overlay-close").attr("href","javascript:;").click(Overlay.close).appendTo(Overlay.wrapper);var b=$("<div/>").addClass("overlay-top").appendTo(Overlay.wrapper);var c=$("<div/>").addClass("overlay-bottom").appendTo(b);var a=$("<div/>").addClass("overlay-middle").appendTo(c);Overlay.loaded=true;},close:function(a){a=!a?10:(a||250);$("#blackout").fadeOut(a);Overlay.wrapper.fadeOut(a,function(){Overlay.setContent("");Overlay.wrapper.attr("class","ui-overlay");if(Overlay.wrapper.attr("id")!=="overlay"){Overlay.wrapper.hide();}});},open:function(b,a){Overlay.initialize();a=$.extend({},Overlay.config,a);if(a.className){Overlay.wrapper.addClass(a.className);}if(a.blackout){if(a.bindClose){Blackout.show(null,function(){Overlay.close(a.fadeSpeed);});}else{Blackout.show();}}if(a.ajax){if(Overlay.cache[b]){Overlay.show(Overlay.cache[b]);$("#overlay").trigger("overlayLoaded");}else{$.ajax({type:"GET",url:b,dataType:"html",beforeSend:function(){Overlay.reset();Overlay.show();},success:function(d,c){Overlay.cache[b]=d;Overlay.setContent(d);$("#overlay").trigger("overlayLoaded");}});}}else{if(b.substr(0,1)==="#"){Overlay.show($(b).html());}else{Overlay.show(b);}}},openCustom:function(b,a){Overlay.wrapper=$(b);if(Overlay.wrapper){a=$.extend({},Overlay.config,a);if(a.blackout){if(a.bindClose){Blackout.show(null,function(){Overlay.close(a.fadeSpeed);});}else{Blackout.show();}}Overlay.position();}},position:function(d){d=d||Overlay.wrapper;var c=d.outerWidth(false),b=d.outerHeight(false),a=(Page.dimensions.width/2)-(c/2),e=(Page.dimensions.height/2)-(b/2);if(Core.isIE(6)){e=Page.scroll.top+e;}d.show().css({left:a+"px",top:e+"px",position:Core.isIE(6)?"absolute":"fixed"});},reset:function(){Overlay.wrapper.find(".overlay-middle").html("").addClass("overlay-loading");},show:function(a){Overlay.setContent(a);Overlay.position();},setContent:function(a){if(a!=null){if(a===""){Overlay.wrapper.find("overlay-middle").empty();}else{Overlay.wrapper.find(".overlay-middle").html(a);}}}};var Page={object:null,loaded:false,dimensions:{width:0,height:0},scroll:{top:0,width:0},initialize:function(){if(Page.loaded){return;}if(!Page.object){Page.object=$(window);}Page.object.resize(Page.getDimensions).scroll(Page.getScrollValues);Page.getScrollValues();Page.getDimensions();Page.loaded=true;},getScrollValues:function(){Page.scroll.top=Page.object.scrollTop();Page.scroll.left=Page.object.scrollLeft();},getDimensions:function(){Page.dimensions.width=Page.object.width();Page.dimensions.height=Page.object.height();}};$(function(){Page.initialize();});var Prompt={node:null,input:null,title:null,errors:null,initialized:false,defaults:{minLength:{value:1},maxLength:{value:25},numeric:{value:false}},rules:{},callback:null,initialize:function(){Prompt.node=$("<div/>").addClass("ui-prompt").click(Core.stopPropagation).appendTo("body");var a=$("<form/>").attr("method","post").attr("action","").addClass("prompt-inner").appendTo(Prompt.node).submit(Core.preventDefault).keyup(function(c){if(c.which===KeyCode.enter){Prompt.validate();}});Prompt.title=$("<h3/>").addClass("subheader").text("").appendTo(a);Prompt.input=$("<input/>").addClass("input").appendTo(a).focus(Input.activate).blur(Input.reset);Prompt.errors=$("<ul/>").addClass("prompt-errors").hide().appendTo(a);var b=$("<div/>").addClass("prompt-buttons").appendTo(a);$('<button type="button"/>').addClass("ui-button button1").html('<span class="button-left"><span class="button-right">'+Msg.ui.submit+"</span></span>").click(Prompt.validate).appendTo(b);$('<button type="button"/>').addClass("ui-button button1").html('<span class="button-left"><span class="button-right">'+Msg.ui.cancel+"</span></span>").click(Prompt.close).appendTo(b);$(document).bind("keyup.prompt",function(c){if(c.which===KeyCode.esc){Prompt.close();}});Prompt.initialized=true;},open:function(e,g,d){if(!Prompt.initialized){Prompt.initialize();}var c=Prompt.node.outerWidth(false),b=Prompt.node.outerHeight(false),a=(Page.dimensions.width/2)-(c/2),f=(Page.dimensions.height/2)-(b/2)+Page.scroll.top;Prompt.rules=$.extend({},Prompt.defaults,d||{});Prompt.callback=g;Prompt.title.text(e);Prompt.input.attr("maxlength",Prompt.rules.maxLength.value);Prompt.node.css({top:f,left:a}).show();Blackout.show(function(){Prompt.input.focus();},Prompt.close);},close:function(){Prompt.input.val("").trigger("blur");Prompt.errors.empty().hide();Prompt.node.hide();Blackout.hide();},validate:function(){var b=Prompt.input,f=b.val().trim(),e=true,h=[],g,d=0,a=0;for(var c in Prompt.rules){g=Prompt.rules[c];e=true;if(!g){continue;}if(typeof g.value==="function"){e=g.value(f);}else{switch(c){case"minLength":if(g.value&&f.length<g.value){e=false;}break;case"maxLength":if(g.value&&f.length>g.value){e=false;}break;case"numeric":if(g.value&&isNaN(f)){e=false;}break;}}if(!e){h.push(g.message||c);}}if(h.length){Prompt.errors.empty().show();for(d=0,a=h.length;d<a;d++){$("<li/>").text(h[d]).appendTo(Prompt.errors);}}else{if(Core.isCallback(Prompt.callback)){Prompt.callback(f);}Prompt.close();}}};var Search={ta:null,map:{articlekeyword:"article",blog:"article",product:"product","static":"static",friend:"friend"},initialize:function(b,c){var a=[];if(Core.project==="wow"){a=["friend","url","wowcharacter","wowguild","wowarenateam","wowitem","article","static","other"];Search.map.character="wowcharacter";Search.map.arenateam="wowarenateam";Search.map.guild="wowguild";Search.map.wowitem="wowitem";Search.map.item="wowitem";Search.map.friend="wowcharacter";}else{a=["friend","url","product","article","static","other","kb"];}Search.ta=TypeAhead.factory(c||"#search-field",{groupResults:true,resultTypes:a,ghostQuery:(Core.region==="us"||Core.region==="eu"||Core.region==="sea"),source:function(d,e){$.ajax({url:b,data:{term:d,locale:Core.formatLocale(2,"_"),community:Core.project},cache:true,dataType:b.charAt(0)==="/"?"json":"jsonp",success:function(h){var k=[];if(h.results){for(var j=0,g;g=h.results[j];j++){var m="",f=$("<div/>").html(g.title||g.term);if(f){m=f.text();}var l={type:Search.map[g.type]||"url",title:m,desc:"",url:"",icon:""};switch(g.type){case"character":l.desc=g.realmName;l.url=Core.baseUrl+"/character/"+g.realmName.replace(/[^a-z0-9]/ig,"-").toLowerCase()+"/"+g.term+"/";break;case"arenateam":l.desc=g.realmName;l.url=Core.baseUrl+"/arena/"+g.realmName.replace(/[^a-z0-9]/ig,"-").toLowerCase()+"/"+g.teamSize+"/"+g.term+"/";break;case"guild":l.desc=g.realmName;l.url=Core.baseUrl+"/guild/"+g.realmName.replace(/[^a-z0-9]/ig,"-").toLowerCase()+"/"+g.term+"/";break;case"wowitem":case"item":l.className="color-q"+g.rarity;l.desc=Core.msg(Msg.cms.ilvl,g.level);l.url=Core.baseUrl+"/item/"+g.objectId;if(g.context){l.url+="/"+g.context;}break;case"url":case"static":case"product":l.desc=g.desc;l.icon=g.icon;l.url=g.url;break;case"friend":l.url=Core.projectUrl+g.url;l.icon=Core.projectUrl+g.icon;break;default:l.url="";if(g.url){l.url=$("<div/>").html(g.url).text();}if(l.title!==g.term){l.desc=g.term||"";}break;}k.push(l);}}e(k);}});}});}};var Storage={initialized:(window.localStorage),get:function(a){if(Storage.initialized&&a){return localStorage.getItem(a);}return null;},getAll:function(e){var c=[];if(!Storage.initialized){return c;}for(var d=0,a=localStorage.length,b=null;d<a;d++){b=localStorage.key(d);if(e&&b.indexOf(e)!==0){continue;}c.push({key:b,value:localStorage[b]});}return c;},has:function(a){return(Storage.get(a)!==null);},set:function(a,b){if(Storage.initialized&&a){try{localStorage.setItem(a,b||"");}catch(c){if(c===QUOTA_EXCEEDED_ERR){alert("Local storage quota exceeded, please clear your saved data.");}}return true;}return false;},clear:function(){if(Storage.initialized){localStorage.clear();}},remove:function(a){if(Storage.initialized&&a){localStorage.removeItem(a);}},size:function(a){if(a){return Storage.getAll(a).length;}return localStorage.length||0;}};var Tickets={tag:null,summary:null,fragment:null,ul:null,doc:null,total:3,initialize:function(){Tickets.doc=document;var a=Tickets.doc;Tickets.tag=a.getElementById("support-ticket-count");Tickets.summary=a.getElementById("ticket-summary");Tickets.fragment=a.createDocumentFragment();Tickets.ul=a.createElement("ul");Tickets.loadStatus();},updateSummary:function(b){var d=Tickets.doc;Tickets.fragment=d.createDocumentFragment();Tickets.ul=d.createElement("ul");Tickets.summary.innerHTML="";Tickets.fragment.appendChild(Tickets.ul);if(b.length<1){return;}for(var a=0,c;c=b[a];a++){Tickets.createListItem(c,a);}Tickets.summary.appendChild(Tickets.fragment);},createListItem:function(j,g){if(typeof j!=="object"){return;}var n=Tickets.doc,e=Core.isIE(6)||Core.isIE(7)?"className":"class",c=Msg.support,b={created:c.ticketNew,status:c.ticketStatus,viewAll:c.ticketAll,OPEN:c.ticketOpen,ANSWERED:c.ticketAnswered,RESOLVED:c.ticketResolved,CANCELED:c.ticketCanceled,ARCHIVED:c.ticketArchived,INFO:c.ticketInfo},f="",d="",p="",k=null,o=null,l=null,m=null,q=null,i=null,h=-1;if(j.status==="OPEN"){f=b.created.replace("{0}",Core.region.toUpperCase()+j.caseId);}else{f=b.status.replace("{0}",Core.region.toUpperCase()+j.caseId);}i=n.createElement("span");i.setAttribute(e,"ticket-datetime");i.appendChild(n.createTextNode(Tickets.localizeDatetime(j.lastUpdate)));l=n.createElement("a");l.href=Core.secureSupportUrl+"ticket/thread/"+j.caseId;k=n.createElement("span"),k.setAttribute(e,"icon-ticket-status");l.appendChild(k);h=f.indexOf("{1}");if(h>0){d=f.substring(0,h);p=f.substr(h+3,f.length);m=n.createElement("span");m.setAttribute(e,"ticket-"+j.status.toLowerCase());m.appendChild(n.createTextNode(b[j.status]));l.appendChild(n.createTextNode(d));l.appendChild(m);l.appendChild(n.createTextNode(p));}else{l.appendChild(n.createTextNode(f));}q=n.createElement("br");l.appendChild(q);l.appendChild(i);o=n.createElement("li");if(g===0){o.setAttribute(e,"first-ticket");}o.appendChild(l);Tickets.ul.appendChild(o);if(g===this.total){o=n.createElement("li");o.setAttribute(e,"view-all-tickets");l=n.createElement("a");l.href=Core.secureSupportUrl+"ticket/status";l.appendChild(n.createTextNode(b.viewAll));o.appendChild(l);Tickets.ul.appendChild(o);}},updateTotal:function(b){b=(typeof b==="number")?b:0;var a=(Core.isIE(6)||Core.isIE(7))?"className":"class";if(b>0){Tickets.tag.setAttribute(a,"open-support-tickets");Tickets.tag.innerHTML=b;}else{Tickets.tag.setAttribute(a,"no-support-tickets");Tickets.tag.innerHTML="";}},localizeDatetime:function(b){var c=Core.dateTimeFormat,a=Core.locale,d=null;d=Core.formatDatetime(c,b);if(!d){return"";}if(a==="en-us"||a==="es-mx"||a==="zh-cn"||a==="zh-tw"){d=d.replace("/0","/");if(d.substr(0,1)==="0"){d=d.substr(1);}}if(a==="en-us"||a==="es-mx"){d=d.replace(" 0"," ");}return d;},loadStatus:function(){if(Tickets.summary!==null){$.ajax({timeout:3000,url:Core.secureSupportUrl+"update/json",ifModified:true,global:false,dataType:"jsonp",jsonpCallback:"getStatus",data:{supportToken:supportToken},success:function(b,a){if("notmodified"!==a){Tickets.updateTotal(b.total);Tickets.updateSummary(b.details,b.total);}}});}}};$(window).on("load",function(){Tickets.initialize();});var Toast={container:null,initialized:false,max:5,options:{timer:15000,autoClose:true,onClick:null},initialize:function(){Toast.container=$("<div/>").attr("id","toast-container").show().appendTo("body");Toast.initialized=true;},create:function(b){var a=$("<div/>").addClass("ui-toast");$("<div/>").addClass("toast-arrow").appendTo(a);$("<div/>").addClass("toast-top").appendTo(a);$("<div/>").addClass("toast-content").appendTo(a).html(b);$("<div/>").addClass("toast-bot").appendTo(a);$("<a/>").addClass("toast-close").attr("href","javascript:;").appendTo(a).click(function(c){c.preventDefault();c.stopPropagation();if(Toast.options.fadeUse){$(this).parent(".ui-toast").fadeOut("normal",function(){$(this).remove();});}else{$(this).parent(".ui-toast").remove();}});a.appendTo(Toast.container).css({height:a.height()}).hide();return a;},show:function(c,b){if(!Toast.initialized){Toast.initialize();}Toast.truncate();var a=Toast.create(c);b=$.extend({},Toast.options,b);if(b.autoClose){window.setTimeout(function(){a.fadeOut("normal",function(){a.remove();});},b.timer);}else{a.click(function(){a.fadeOut("normal",function(){a.remove();});}).css("cursor","pointer");}if(Core.isCallback(b.onClick)){a.click(b.onClick).css("cursor","pointer");}a.fadeIn();},truncate:function(){var a=Toast.container.find(".ui-toast");if(a.length>Toast.max){Toast.container.find(".ui-toast:lt("+Math.round(a.length-Toast.max)+")").fadeOut();}}};var Toggle={cache:{},callback:null,timeout:800,keepOpen:false,open:function(e,d,f,b){if(b){Toggle.timeout=b;}Toggle.keepOpen=true;var c=Toggle.key(f);for(var a in Toggle.cache){if(a!==c){Toggle.close(Toggle.cache[a].trigger,Toggle.cache[a].activeClass,Toggle.cache[a].target,0,true);}}if(!Toggle.cache[c]){$(e).mouseleave(function(){Toggle.keepOpen=false;Toggle.close(e,d,f,Toggle.timeout);}).mouseenter(function(){Toggle.keepOpen=true;window.clearTimeout(Toggle.cache[c].timer);});$(f).mouseleave(function(){Toggle.keepOpen=false;Toggle.close(e,d,f,Toggle.timeout);}).mouseenter(function(){Toggle.keepOpen=true;window.clearTimeout(Toggle.cache[c].timer);});Toggle.cache[c]={trigger:e,target:f,activeClass:d,key:c,timer:null};}$(e).toggleClass(d);$(f).toggle();window.clearTimeout(Toggle.cache[c].timer);},close:function(d,c,f,a,e){e=(typeof e==="boolean")?e:false;var b=Toggle.key(f);window.clearTimeout(Toggle.cache[b].timer);Toggle.cache[b].timer=setTimeout(function(){if(Toggle.keepOpen&&!e){return;}$(f).hide();$(d).removeClass(c);Toggle.triggerCallback();},a);},key:function(a){return(typeof a==="string")?a:"#"+$(a).attr("id");},triggerCallback:function(){if(Core.isCallback(Toggle.callback)){Toggle.callback();}}};var Tooltip={wrapper:null,wrapperFrame:null,contentCell:null,cache:{},currentNode:null,visible:false,options:{},query:null,maxWidth:250,threshold:100,initialized:false,instances:{},factory:function(c,b){var a=Object.create(Tooltip);a.init(c,b);Tooltip.instances[b.key||c]=a;return a;},init:function(f,i){this.query=f;this.options=$.extend({},{ajax:false,mode:"hover",className:"",location:"topRight",useTable:false,showLoading:true,onShow:null,onPosition:null,context:null,margin:10},i);if(Core.project==="sc2"){this.options.useTable=true;}i=this.options;var b=$("<div/>").addClass("ui-tooltip").appendTo("body").hide();if(Core.isIE(6)){this.wrapperFrame=$("<iframe/>",{src:'javascript:"";',frameborder:0,scrolling:"no",marginwidth:0,marginheight:0}).addClass("tooltip-frame").appendTo("body");}if(!i.useTable){this.contentCell=$("<div/>").addClass("tooltip-content").appendTo(b);}else{var e=$("<table/>",{cellspacing:0,cellpadding:0}).appendTo(b);var d=$("<td/>").attr("valign","top").text(" "),g=$("<tr/>"),a=d.clone();e.append(g.clone().append(d.clone().addClass("top-left")).append(d.clone().addClass("top-center")).append(d.clone().addClass("top-right"))).append(g.clone().append(d.clone().addClass("middle-left")).append(a.addClass("middle-center")).append(d.clone().addClass("middle-right"))).append(g.clone().append(d.clone().addClass("bottom-left")).append(d.clone().addClass("bottom-center")).append(d.clone().addClass("bottom-right")));this.contentCell=a;}this.wrapper=b;var c=(i.mode==="click")?"click":"mouseover",h=(typeof i.onShow==="function")?i.onShow:function(l){var k=$(l.currentTarget),j=k.data("tooltip")||k.prop("title");if(c==="click"&&this.visible){this.hide();return;}if(j&&k.attr("rel")!=="np"){this.show(k,j,k.data("tooltip-options")||this.options);}};$(i.context||document).off(c+".tooltip",f,$.proxy(h,this)).on(c+".tooltip",f,$.proxy(h,this));this.initialized=true;},show:function(d,c,b){if(!this.initialized){if(Core.userAgent!="mobile"){Tooltip.instances.common.show(d,c,b);}return;}if(b===true){b={ajax:true};}b=$.extend({},this.options,b||{});this.currentNode=d=$(d);if(b.mode!=="click"){d.unbind("mouseout.tooltip").bind("mouseout.tooltip",$.proxy(function(){this.hide();this.wrapper.removeClass(b.location).removeClass(b.className);},this));}if(!this["_"+b.location]){b.location="topRight";}if(b.location===this.options.location&&d.offset().left>$(window).width()/2){b.location="topLeft";}this.wrapper.addClass(b.location);if(b.className){this.wrapper.addClass(b.className);}if(typeof c==="object"){this._position(d,c,b);}else{if(typeof c==="string"){if(b.ajax){if(this.cache[c]){this._position(d,this.cache[c],b);}else{var a=c;if(a.indexOf(Core.projectUrl)!==0){a=Core.baseUrl+c;}if(b.showLoading){window.setTimeout($.proxy(function(){if(!this.visible&&!this.cache[c]){this._position(d,Msg.ui.loading,b);}},this),500);}$.ajax({type:"GET",url:a,dataType:"html",global:false,success:$.proxy(function(e){this.cache[c]=e;if(this.currentNode===d){this._position(d,e,b);}},this),error:$.proxy(function(e){if(e.status!==200){this.hide();}},this)});}}else{if(c.substr(0,1)==="#"){this._position(d,$(c).html(),b);}else{this._position(d,c,b);}}}}},hide:function(){if(this.initialized){if(Core.isIE(6)){this.wrapperFrame.hide();this.wrapper.removeAttr("style");}this.wrapper.hide().unbind("mousemove.tooltip").removeClass(this.options.location).removeClass(this.options.className);this.currentNode=null;this.visible=false;}else{for(var a in Tooltip.instances){Tooltip.instances[a].hide();}}},move:function(a,d,b,c){this.wrapper.css("left",a+"px").css("top",d+"px").show();this.visible=true;if(Core.isIE(6)){this.wrapperFrame.css({width:b+60,height:c,left:(a-60)+"px",top:d+"px"}).fadeTo(0,0).show();this.wrapper.css("width",b);}},_position:function(e,d,b){if(typeof b.onPosition==="function"){d=b.onPosition(d);}if(typeof d==="string"){this.contentCell.html(d);}else{this.contentCell.empty().append(d);}var c=this.wrapper.outerWidth(false),a=this.wrapper.outerHeight(false);if(Core.isIE(6)&&c>Tooltip.maxWidth){c=Tooltip.maxWidth;}var f=this["_"+b.location](c,a,e);if(f){this.move(f.x,f.y,c,a);}},_mouse:function(b,a,c){c.unbind("mousemove.tooltip").bind("mousemove.tooltip",$.proxy(function(f){var d=this.options.margin;this.move((f.pageX+d),(f.pageY+d),b,a);},this));},_topLeft:function(c,b,d){var e=d.offset(),a=e.left-c,f=e.top-b;return this._checkViewport(a,f,c,b,d);},_topCenter:function(d,b,e){var f=e.offset(),c=e.outerWidth(false),a=f.left+((c/2)-(d/2)),g=f.top-b-5;return this._checkViewport(a,g,d,b,e);},_topRight:function(d,b,e){var f=e.offset(),c=e.outerWidth(false),a=f.left+c,g=f.top-b;return this._checkViewport(a,g,d,b,e);},_middleLeft:function(c,b,d){var f=d.offset(),e=d.outerHeight(false),a=f.left-c,g=(f.top+(e/2))-(b/2);return this._checkViewport(a,g,c,b,d);},_middleRight:function(d,b,e){var g=e.offset(),c=e.outerWidth(false),f=e.outerHeight(false),a=g.left+c,h=(g.top+(f/2))-(b/2);return this._checkViewport(a,h,d,b,e);},_bottomLeft:function(c,b,d){var f=d.offset(),e=d.outerHeight(false),a=f.left-c,g=f.top+e;return this._checkViewport(a,g,c,b,d);},_bottomCenter:function(d,b,e){var g=e.offset(),c=e.outerWidth(false),f=e.outerHeight(false),a=g.left+((c/2)-(d/2)),h=g.top+f+5;return this._checkViewport(a,h,d,b,e);},_bottomRight:function(d,b,e){var g=e.offset(),c=e.outerWidth(false),f=e.outerHeight(false),a=g.left+c,h=g.top+f;return this._checkViewport(a,h,d,b,e);},_checkViewport:function(f,e,a,i,b){var d=b.offset(),g=Page.scroll,h=Page.dimensions,c=this.options.margin;if((f+a)>h.width){f=h.width-a;}if(f<0){f=c;}if((e+i)>(g.top+h.height)){e=e-((e+i)-(g.top+h.height));}else{if((d.top-Tooltip.threshold)<g.top){e=d.top+b.outerHeight(false);}else{if(e<g.top){e=g.top+c;}}}if(e<0){e=c;}return{x:f,y:e};}};$(function(){if(Core.userAgent!="mobile"){Tooltip.factory("[data-tooltip]",{key:"common"});}});var TypeAhead={node:null,html:null,timer:null,term:"",position:-1,items:[],cache:[],config:{},factory:function(c,b){var a=Object.create(TypeAhead);a.init(c,b);return a;},init:function(b,a){this.node=$(b);if(!this.node.length){return false;}this.config=$.extend({},{minLength:3,resultsLength:15,groupResults:false,termMatch:false,resultTypes:[],ghostQuery:false,useSearchList:false,selectKey:KeyCode.enter,throttle:200,source:null,onSelect:function(d,c){c.node.val(d.title||"");c.close();},onStart:null,onFinish:null},a||{});if(this.config.minLength<=0){this.config.minLength=1;}this.config.resultTypes.push("default");if(this.node.prop("nodeName").toLowerCase()==="input"){this.node.bind("keyup.ta",$.proxy(this.listen,this));this.node.bind("keydown.ta",$.proxy(this.trigger,this));this.html=$("<div/>").addClass("ui-typeahead").html(Msg.ui.loading).hide().appendTo("body");if(this.config.ghostQuery){this.ghost=$("<input/>").attr({type:"text",value:"",autocomplete:"off",readonly:"readonly","class":this.node.attr("class")}).addClass("input input-ghost").focus(function(){$(b).focus();});this.node.wrap($("<div/>").addClass("ui-typeahead-ghost")).before(this.ghost);}$(document).bind("click.ta",$.proxy(this.close,this));this.node.bind("click.ta",Core.stopPropagation);this.html.bind("click.ta",Core.stopPropagation);}},close:function(){this.position=-1;this.html.hide();this._setGhostText();},finish:function(a){var b=this.config;this.items=a||[];this.cache=[];this._populate();this._position();if(Core.isCallback(b.onFinish)){b.onFinish(this.term,this);}},highlight:function(c,b){if(!b){b=c;}var e=this.term.replace(/[-[\]{}()*+?.,\\^$|#]/g,"\\$&").split(" ");for(var d=0,g;g=e[d];d++){var a=b.toLowerCase().indexOf(g.toLowerCase());var f=g.length;b=c.substr(0,a)+"<em>"+c.substr(a,f)+"</em>"+c.substr(a+f);}return b;},listen:function(){this.term=this.node.val();if(this.term.length<=0){this.close();}else{this._checkGhostText();}},start:function(){var a=this.config,b=$.type(a.source);if(Core.isCallback(a.onStart)){a.onStart(this.term,this);}if(b==="function"){a.source(this.term,$.proxy(this.finish,this));}else{if(b==="array"){this.finish(a.source);}}},throttle:function(){if(this.timer!==null){window.clearTimeout(this.timer);this.timer=null;}this.timer=window.setTimeout($.proxy(this.start,this),this.config.throttle);},trigger:function(h){var f=h.which,c=this.config,g=this.node.val();this._checkGhostText();if(!(f===KeyCode.arrowUp||f===KeyCode.arrowDown||f===c.selectKey||f===KeyCode.tab)){if((g.length+1)>=this.config.minLength){this.term=g.trim();this.throttle();}else{if(g.length<=0){this.close();}}return;}if(f===KeyCode.enter&&(this.html.is(":hidden")||this.position===-1)){this.node.parentsUntil("form").parent().submit();}else{h.preventDefault();h.stopPropagation();}var b=this.cache,a=this.html.find("a");a.removeClass("item-active");this._setGhostText();if(f===c.selectKey){if(this.position!=-1&&b[this.position]){var d=b[this.position];if(Core.isCallback(c.onSelect)){c.onSelect(d,this);}else{if(d.url){Core.goTo(d.url);}}}}else{if(f===KeyCode.arrowDown){this.position++;if(this.position>=a.length){this.position=0;}}else{if(f===KeyCode.arrowUp){this.position--;if(this.position<=-1){this.position=a.length-1;}}else{if(f===KeyCode.tab){this.position=0;}}}if(b[this.position]){a.eq(this.position).addClass("item-active");this.node.val(b[this.position].title);}}},_position:function(){if(!this.items.length){this.close();return;}var a=this.node.offset();this.html.css({width:this.node.outerWidth(false),left:a.left,top:a.top+this.node.outerHeight(false)}).show();},_populate:function(){if(!this.items.length){return;}this.html.empty();this.position=-1;var d=this.config,j=this.items,g=this.term,e={};if(d.groupResults){for(var k=0,s;s=j[k];k++){if(!e[s.type]){e[s.type]=[];}e[s.type].push(s);}}else{e["default"]=j;}var c,l,q,p,b=0;for(var k=0,m;m=d.resultTypes[k];k++){if(b>=d.resultsLength){break;}if(e[m]){var o=false;l=$("<ul/>");for(var n=0,r;r=e[m][n];n++){var f=this.config.useSearchList?r.searchTerm:r.title;if(b>=d.resultsLength){break;}else{if(d.termMatch&&f.toLowerCase().indexOf(g.toLowerCase())<=-1){continue;}}p='<span class="title">'+this.highlight($("<div/>").text(r.title).html(),f)+"</span>";if(r.desc){p+=' <span class="desc">'+$("<div/>").text(r.desc).html()+"</span>";}q=$("<a/>",{href:r.url,html:p,"class":r.className||""});if(r.icon||m==="friend"){var h=$("<img/>",{src:r.icon,width:(m==="product")?100:38,height:(m==="product")?50:38,"class":"icon"+((m==="friend")?" icon-frame":"")});q.html($('<div class="icon-desc"/>').append(q.html()));q.prepend(h);q.append($('<span class="clear"/>'));}$("<li/>").append(q).appendTo(l);b++;o=true;this.cache.push(r);}if(o){c=$("<div/>").addClass("group-list group-"+m);if(Msg.search&&Msg.search[m]){$("<span/>").addClass("group-title").html(Msg.search[m]).appendTo(c);}c.append(l).appendTo(this.html);}}}if(b){this._checkGhostText();}},_setGhostText:function(a){if(this.ghost){this.ghost.val(a||"");}},_checkGhostText:function(){if(this.ghost){if(this.cache[0]){var b=this.cache[0].title.trim(),a=this.node.val().trim();if(b.toLowerCase().indexOf(a.toLowerCase())===0){b=a+b.substr(a.length,(b.length-a.length));}else{b="";}this._setGhostText(b);}else{this._setGhostText();}}}};var Comments={key:null,sig:null,count:0,wrapper:null,replyForm:null,replyInput:null,replyId:null,collection:null,throttleTimer:null,defaultCommentSort:"best",commentSortCookie:"discussion.sort",initialize:function(b,d){var e=$("#comments"),c=$(document);Comments.key=b;Comments.sig=d;Comments.wrapper=e;if(e.length&&b&&d){var a=Cookie.read(Comments.commentSortCookie);Comments.loadBase(1,null,a);}c.delegate("#comments a.body-read","click",Comments.moreLess);c.delegate("#comments .ui-pagination a","click",Comments.loadPage);c.delegate("#comments .ui-pagination .page-next","click",Comments.loadPage);c.delegate("#comments .ui-pagination .page-prev","click",Comments.loadPage);c.delegate("#comments #comments-sorting-tabs .menu-best a","click",function(f){if(!$(this).hasClass("tab-active")){Comments.switchSortOrder("best");}});c.delegate("#comments #comments-sorting-tabs .menu-latest a","click",function(f){if(!$(this).hasClass("tab-active")){Comments.switchSortOrder("latest");}});if(Core.isIE(6)){c.delegate("#comments .comments-list li",{mouseover:function(){$(this).addClass("tile-hover");},mouseout:function(){$(this).removeClass("tile-hover");}});}},switchSortOrder:function(a){Cookie.create(Comments.commentSortCookie,a,{expires:8760,path:"/"});Comments.loadBase(1,null,a);},add:function(c,g,h){c=$(c);c.addClass("disabled").attr("disabled","disabled");var e=c.parentsUntil("form").parent(),d=e.find("textarea"),b=e.find(".comments-error-form");b.find("li").hide();if(Comments.validate(e)){var a=new Date();a=a.getTime();var f={detail:$.trim(d.val()),sig:Comments.sig,xstoken:Cookie.read("xstoken"),base:false,nocache:a};if(g&&Comments.collection){f.replyCommentId=Comments.replyId;}$.ajax({url:Core.baseUrl+"/discussion/"+Comments.key+"/comment.json",type:"POST",data:f,dataType:"json",success:function(i){d.val("");c.removeClass("disabled").removeAttr("disabled");Comments.cancelReply();if(i.commentId){if(!g){Comments.loadBase(1,h,"latest");}else{Comments.loadBase(1,h);}}else{Comments.showErrors(b,i.errors||["throttled"]);c.removeClass("disabled").removeAttr("disabled");}},error:function(i){Overlay.open(i.statusText);c.removeClass("disabled").removeAttr("disabled");}});}else{Comments.showErrors(b,["required"]);c.removeClass("disabled").removeAttr("disabled");}return false;},decrement:function(){var b=$("#comments-total"),a=parseInt(b.text());b.text(a-1);},increment:function(){var b=$("#comments-total"),a=parseInt(b.text());b.text(a+1);},reply:function(a,d,b){if(Comments.throttleTimer!==null){return;}var c=$("#post-"+a);if(a===Comments.replyId){c.next().toggle();return;}Comments.cancelReply();Comments.collection=d;Comments.replyId=a;$("#comments li.nested-reply").remove();$("<li/>").addClass("nested-reply").append(Comments.replyForm).insertAfter(c);Comments.replyInput.focus().val("@"+b+": ");},cancelReply:function(){Comments.replyId=null;Comments.collection=null;Comments.replyForm.detach();Comments.replyInput.val("");return false;},toggleDelete:function(a){$("#post-"+a).find(".comment-foot").toggle().toggleClass("visible");},remove:function(b){var a=new Date();a=a.getTime();$.ajax({url:Core.baseUrl+"/discussion/comment/"+b+"/delete.json",type:"POST",data:{sig:Comments.sig,xstoken:Cookie.read("xstoken"),nocache:a},dataType:"json",success:function(c){if(c.success){Marketing.trackActivity("Comments","Delete Comment");$("#post-"+b).fadeOut("normal",function(){$(this).remove();Comments.decrement();});}}});},loadBase:function(c,d,b){var a=new Date();a=a.getTime();c=c||1;b=b||Core.getHash()||Cookie.read("discussion.sort")||Comments.defaultCommentSort;$.ajax({url:Core.baseUrl+"/discussion/"+Comments.key+"/load.json",type:"GET",data:{page:c,base:true,sig:Comments.sig,xstoken:Cookie.read("xstoken"),nocache:a,view:b},dataType:"html",success:function(e){var f=$(e),g=Comments.wrapper;f.insertBefore(g);g.remove();Comments.wrapper=f;Comments.replyForm=$("#comments-reply-form").detach().show();Comments.replyInput=Comments.replyForm.find("textarea");ReportPost.initialize(f,"comments");if(Core.isCallback(d)){d();}},error:function(e){Comments.wrapper.addClass("comments-error").find(".subheader-2").toggleClass("hide");}});},loadPage:function(h){h.preventDefault();h.stopPropagation();var b=new Date();b=b.getTime();var c=Core.getHash()||Cookie.read("discussion.sort")||Comments.defaultCommentSort;var d=$(h.currentTarget),g=parseInt(d.text())||parseInt(d.data("pagenum"))||1,f=$("#comments-"+g),a=Comments.wrapper.find(".comments-pages");$.ajax({url:Core.baseUrl+"/discussion/"+Comments.key+"/load.json",type:"GET",data:{page:g,sig:Comments.sig,xstoken:Cookie.read("xstoken"),base:false,nocache:b,view:c},dataType:"html",success:function(e){if(e){Marketing.trackActivity("Comments","Load Page#"+g);$("#comments-list-wrapper").html(e);ReportPost.initialize($("#comments"),"comments");}}});},purge:function(b,c){if(!confirm(c)){return false;}$(b).addClass("disabled").attr("disabled","disabled");var a=new Date();a=a.getTime();$.ajax({url:Core.baseUrl+"/discussion/"+Comments.key+"/purge.json",type:"POST",data:{sig:Comments.sig,xstoken:Cookie.read("xstoken"),nocache:a},dataType:"json",success:function(){Comments.loadBase();}});},poll:function(){var a=new Date();a=a.getTime();$.ajax({url:Core.baseUrl+"/discussion/"+Comments.key+"/poll.json",type:"GET",data:{sig:Comments.sig,xstoken:Cookie.read("xstoken"),nocache:a},dataType:"json",success:function(b){if(b.count&&b.count>Comments.count){var d=b.count-Comments.count,c=$("#comments-pull");c.find(".pull-single, .pull-multiple").hide();c.find(".pull-"+(d===1?"single":"multiple")).show().find("span").text(d);c.slideDown();}}});},lock:function(b){$(b).addClass("disabled").attr("disabled","disabled");var a=new Date();a=a.getTime();$.ajax({url:Core.baseUrl+"/discussion/"+Comments.key+"/toggleLock.json",type:"POST",data:{sig:Comments.sig,xstoken:Cookie.read("xstoken"),nocache:a},dataType:"json",success:function(){Comments.loadBase();}});},moreLess:function(c){c.stop();var a=$(this),b=a.parent();b.hide();b.siblings().show();return false;},showErrors:function(c,d){for(var b=0,a=d.length;b<a;b++){c.find(".error-"+d[b]).show();}},throttle:function(b){var a=Math.ceil(b/1000),d=$("#comments .comments-throttler"),c=$("#comments .comments-action");if(d.length&&a<=60){d.find(".throttle-time").text(60-a);d.show();c.hide();$(".reply-button").attr("data-tooltip",Msg.cms.throttleError).addClass("disabled");clearTimeout(Comments.throttleTimer);Comments.throttleTimer=setTimeout(function(){Comments.countdown(d,c);},1000);}},countdown:function(d,a){var b=parseInt(d.eq(0).find(".throttle-time").text())||60,c=b-1;clearTimeout(Comments.throttleTimer);if(c<=0){Comments.throttleTimer=null;d.hide();a.show();$(".reply-button").removeAttr("data-tooltip").removeClass("disabled");}else{d.find(".throttle-time").text(c);Comments.throttleTimer=setTimeout(function(){Comments.countdown(d,a);},1000);}},updateHistory:function(a){History.push({key:Comments.key,sig:Comments.sig,page:a},"?page="+a+"#comments");},updatePagination:function(a){Comments.wrapper.find(".ui-pagination").each(function(){$(this).find("li").removeClass("current").eq(a-1).addClass("current");});},unbury:function(a){$("#post-"+a).removeClass("comment-buried");},validate:function(a){return($.trim(a.find("textarea").val())!=="");}};var ReportPost={contextWrapper:null,formWrapper:null,offensiveId:null,offensiveAuthor:null,initialize:function(b,a){if(typeof wrapperId==="string"){ReportPost.contextWrapper=$(wrapperId);}else{ReportPost.contextWrapper=b;}ReportPost.formWrapper=$("#report-post");ReportPost.offensiveId=$("#offensive-post-id");ReportPost.offensiveAuthor=$("#offensive-post-author");ReportPost.reportReason=$("#report-detail");ReportPost.reportSuccess=$("#report-success");ReportPost.postType=a;ReportPost.bindEvents();},bindEvents:function(){$("a[data-vote-type='up']",ReportPost.contextWrapper).on("click",function(){ReportPost.ratePost(this);});$("a[data-vote-type='down']",ReportPost.contextWrapper).on("click",function(){ReportPost.ratePost(this);});$("a[data-vote-type='report']",ReportPost.contextWrapper).on("click",function(){ReportPost.openReportForm(this);});$(".report-submit",ReportPost.formWrapper).on("click",ReportPost.submitReport);$(".cancel-report",ReportPost.formWrapper).on("click",ReportPost.cancelReport);var a=(ReportPost.postType==="forums")?".topic-post":".comment-tile";if(!Core.isIE(6)&&!Core.isIE(7)){$(ReportPost.contextWrapper).on("mouseover",a,function(b){if(Core.loggedIn){$(".rate-up, .downvote-wrapper",this).not(".keep-shown").css("visibility","visible");}else{$(".rate-post-wrapper",this).css("visibility","visible");}}).on("mouseout",a,function(b){if(Core.loggedIn){$(".rate-up, .downvote-wrapper",this).not(".keep-shown").css("visibility","hidden");}else{$(".rate-post-wrapper",this).css("visibility","hidden");}});}},ratePost:function(d){d=$(d);var a=d.data("post-id");var b=d.data("vote-type");var e=d.data("report-type");var c=Core.baseUrl;if(ReportPost.postType==="comments"){c+="/discussion/comment/";}else{c+="/forum/topic/post/";}c+=(a+"/"+b);$.ajax({type:"POST",url:c,data:{voteValue:e,xstoken:Cookie.read("xstoken")},success:function(f){if(f.vote>0){d.addClass("keep-shown").parents(".rate-post-wrapper").addClass("upvoted").removeClass("downvoted");}else{if(f.vote<0){d.parents(".rate-option").addClass("keep-shown").parents(".rate-post-wrapper").addClass("downvoted").removeClass("upvoted");}else{$(".keep-shown").removeClass("keep-shown");d.parents(".rate-post-wrapper").removeClass("downvoted").removeClass("upvoted");}}if(b==="down"){d.parents(".downvote-menu").hide();}},error:function(h,f,g){if(b==="down"){d.parents(".downvote-menu").hide();}if(h.statusText.length===0){Core.goTo(window.location+"?login");return false;}Overlay.open(h.statusText);}});},openReportForm:function(c){c=$(c);var a=c.data("post-id");var b=c.data("vote-type");var d=c.data("report-type");ReportPost.formWrapper.insertAfter($("#post-"+a)).show();$("#report-success").hide();$("#report-table").show();c.parents(".downvote-menu").hide();ReportPost.offensiveId.html(c.data("post-id"));ReportPost.offensiveAuthor.html(c.data("post-author"));},submitReport:function(){var a=ReportPost.offensiveId.html();var c=$("#report-detail").val();if(c===""){Overlay.open(Msg.cms.validationError);return;}var b=Core.baseUrl;if(ReportPost.postType==="comments"){b+="/discussion/comment/";}else{b+="/forum/topic/post/";}b+=(a+"/report");$.ajax({type:"POST",url:b,data:{type:$("#report-reason").val(),reason:c,xstoken:Cookie.read("xstoken")},success:function(d){$("#report-success").show();$("#report-table").hide();ReportPost.offensiveId.html("");ReportPost.offensiveAuthor.html("");},error:function(f,d,e){Overlay.open(f.statusText);}});},cancelReport:function(){ReportPost.formWrapper.hide();ReportPost.offensiveId.html("");ReportPost.offensiveAuthor.html("");if(ReportPost.postType==="comments"){ReportPost.formWrapper.insertAfter("#comments");}else{ReportPost.formWrapper.insertAfter("#post-list");}},ignoreUser:function(e,f,a){e=$(e);e.parents(".ui-context").hide();var d=Cookie.read("bnetUserIgnore");d=(d!=null)?decodeURIComponent(d).split(","):[];var b=$.inArray(f.toString(),d);var c=false;if(a){if(b>-1){d.splice(b,1);c=ReportPost.updateIgnoreList(d);}else{Overlay.open(Msg.cms.ignoreNot);}}else{if(b<0){d.push(f);if(d.length>100){d.shift();}c=ReportPost.updateIgnoreList(d);}else{Overlay.open(Msg.cms.ignoreAlready);}}if(c){window.location.reload();}},updateIgnoreList:function(a){Cookie.create("bnetUserIgnore",encodeURIComponent(a.join(",")),{path:Core.baseUrl,expires:8760});return true;}};"use strict";var Lightbox={timeout:0,initialized:false,contents:[],currentIndex:0,contentType:"image",DEFAULT_WIDTH:480,DEFAULT_HEIGHT:360,anchorClose:true,config:{showTitle:false,includeControls:false},init:function(){Blackout.initialize();Lightbox.build();Lightbox.initialized=true;},storeContentData:function(a,b){if(!Lightbox.initialized){Lightbox.init();}Lightbox.contents=a;Lightbox.contentType=b;Lightbox.currentIndex=0;Lightbox.controls.toggleClass("no-paging",(a.length<2));},loadImage:function(a,d,b){if(!Lightbox.initialized){Lightbox.init();}if(!d){Lightbox.storeContentData(a,"image");}var c=b||((typeof a==="number")?a:0);if(Lightbox.contents[c].src!==""){Lightbox.currentIndex=c;Lightbox.setFrameDimensions(Lightbox.DEFAULT_WIDTH,Lightbox.DEFAULT_HEIGHT);Lightbox.content.removeAttr("style").addClass("loading").removeClass("lightbox-error").html("");Lightbox.show();Lightbox.setImage(Lightbox.contents[c]);}else{Lightbox.error();}},setImage:function(a){if(Core.isIE(6)){if(Lightbox.controls.hasClass("no-paging")&&Lightbox.controls.hasClass("no-gallery")){Lightbox.controls.addClass("no-controls").removeClass("no-paging no-gallery");}}Lightbox.preloadImage(a,function(b){Lightbox.emptyContent();Lightbox.setFrameDimensions(b.width,b.height);Lightbox.content.html(b);if(Lightbox.config.showTitle){Lightbox.title.html(a.title||"");}});},loadVideo:function(c,d,a){if(!Lightbox.initialized){Lightbox.init();}if(!d){Lightbox.storeContentData(c,"video");}var b=a||((typeof c==="number")?c:0);Lightbox.setVideo(c[b]);},setVideo:function(b){var c={flvPath:(b.flvBase||Flash.videoBase)+b.flvPath,flvWidth:b.width,flvHeight:b.height,ratingPath:b.customRating,captionsPath:"",captionsDefaultOn:(Core.locale!=="en-us"&&Core.locale!=="en-gb")};if(!b.showRating||false){c=$.extend(Flash.defaultVideoFlashVars,c);}var a=new Date();a="?nocache="+a.getTime();if(typeof b.captionsPath!=="undefined"&&b.captionsPath!==""){c.captionsPath=b.captionsPath;}else{delete c.captionsPath;}if(typeof b.customRating!=="undefined"&&b.customRating!==""){if(b.customRating.indexOf("NONE")>-1){delete c.ratingPath;}else{c.ratingPath=b.customRating;}}else{c.ratingPath=Flash.ratingImage;}Lightbox.emptyContent();$("<div id='flash-target' />").appendTo(Lightbox.content);swfobject.embedSWF(Flash.videoPlayer+a,"flash-target",b.width,b.height,Flash.requiredVersion,Flash.expressInstall,c,Flash.defaultVideoParams,{},Lightbox.flashEmbedCallback);if(Lightbox.config.showTitle){Lightbox.title.html(b.title||"");}Lightbox.setFrameDimensions(b.width,b.height);Lightbox.show();},loadEmbed:function(d,c,a){if(!Lightbox.initialized){Lightbox.init();}if(!c){Lightbox.storeContentData(d,"embed");}var b=a||((typeof d==="number")?d:0);Lightbox.setEmbed(d[b]);},setEmbed:function(a){Lightbox.emptyContent();$("<object width='"+a.width+"' height='"+a.height+"'><param name='movie' value='https://www.youtube.com/v/"+a.src+"?autoplay=1'/><param name='allowFullScreen' value='true' /><param name='allowScriptAccess' value='always'/><param name='wmode' value='opaque' /><embed src='https://www.youtube.com/v/"+a.src+"?autoplay=1' type='application/x-shockwave-flash' allowfullscreen='true' allowScriptAccess='always' wmode='opaque' width='"+a.width+"' height='"+a.height+"'/></object>").appendTo(Lightbox.content);if(Lightbox.config.showTitle){Lightbox.title.html(a.title||"");}Lightbox.setFrameDimensions(a.width,a.height);Lightbox.show();},viewInGallery:function(){Tooltip.hide();Core.goTo(Lightbox.contents[Lightbox.currentIndex].path);return false;},setFrameDimensions:function(b,a){if(b===0||a===0){Lightbox.error();}else{Lightbox.content.css({height:a+"px"});a=(Lightbox.config.showTitle)?a+Lightbox.title.height():a;a=(Lightbox.config.includeControls)?a+Lightbox.controls.height():a;Lightbox.container.css({top:Page.scroll.top+"px",width:b+"px",height:a+"px"});Lightbox.borderTop.width(b-10+"px");Lightbox.borderbottom.width(b-12+"px");Lightbox.borderRight.height(a-9+"px");Lightbox.borderLeft.height(a-9+"px");}},checkGalleryLinkDisplay:function(a){Lightbox.controls.toggleClass("no-gallery",a);},preloadImage:function(b,c){var a=new Image();$(a).load(function(){c(a);});a.src=b.src;},show:function(){Blackout.show(function(){Lightbox.container[0].style.display="block";Lightbox.checkGalleryLinkDisplay(!(Lightbox.contents[Lightbox.currentIndex].path));},Lightbox.close);},close:function(){clearTimeout(Lightbox.timeout);Blackout.hide(Lightbox.container.hide());if(Lightbox.contentType==="video"){swfobject.removeSWF("flash-target");}if(Lightbox.contentType==="embed"){Lightbox.emptyContent();}Tooltip.hide();},emptyContent:function(){Lightbox.content.removeAttr("style").removeClass("loading lightbox-error").empty();},error:function(){Lightbox.emptyContent();Lightbox.setFrameDimensions(Lightbox.DEFAULT_WIDTH,Lightbox.DEFAULT_HEIGHT);Lightbox.content.addClass("lightbox-error").html("Error loading content.");Lightbox.show();},build:function(){Lightbox.anchor=$('<div id="lightbox-anchor" />').click(function(){if(Lightbox.anchorClose){Lightbox.close();}});Lightbox.container=$('<div id="lightbox-container" />').mouseover(function(){Lightbox.anchorClose=false;}).mouseout(function(){Lightbox.anchorClose=true;}).appendTo(Lightbox.anchor);Lightbox.title=$('<h1 id="lightbox-title" />').mouseover(function(){Lightbox.anchorClose=false;}).mouseout(function(){Lightbox.anchorClose=true;}).appendTo(Lightbox.container);Lightbox.content=$('<div id="lightbox-content"/>').mouseover(function(){Lightbox.anchorClose=false;}).mouseout(function(){Lightbox.anchorClose=true;}).appendTo(Lightbox.container).click(Lightbox.next);var b=$("<a />").addClass("ui-element").attr("href","javascript:;");Lightbox.controls=$('<div class="control-wrapper no-paging no-gallery" />');Lightbox.controls.append($('<div class="lightbox-controls ui-element" />').append(b.clone().addClass("previous").click(Lightbox.previous)).append(b.clone().addClass("next").click(Lightbox.next)).append(b.clone().addClass("gallery-view").click(Lightbox.viewInGallery).mouseover(function(){Tooltip.instances.common.show(this,Msg.ui.viewInGallery);Tooltip.instances.common.wrapper.css("z-index","9007");}).mouseout(function(){Tooltip.instances.common.wrapper.css("z-index","1000");})));var a=$("<div />").addClass("border");Lightbox.borderTop=a.clone().attr("id","lb-border-top");Lightbox.borderRight=a.clone().attr("id","lb-border-right");Lightbox.borderbottom=a.clone().attr("id","lb-border-bottom");Lightbox.borderLeft=a.clone().attr("id","lb-border-left");var c=$("<div />").addClass("corner");Lightbox.container.append(c.clone().addClass("corner-top-left")).append(c.clone().addClass("corner-top-right")).append(c.clone().addClass("corner-bottom-left")).append(c.clone().addClass("corner-bottom-right")).append(Lightbox.borderTop).append(Lightbox.borderRight).append(Lightbox.borderbottom).append(Lightbox.borderLeft).append(Lightbox.controls).append(b.clone().addClass("lightbox-close").click(Lightbox.close));Lightbox.anchor.appendTo("body");if(Core.isIE(6)){Lightbox.content.show().hide();}},next:function(){var a=Lightbox.contents.length;if(a>1){Lightbox.currentIndex++;if(Lightbox.currentIndex>=a){Lightbox.currentIndex=0;}if(Lightbox.contentType==="image"){Lightbox.setImage(Lightbox.contents[Lightbox.currentIndex]);}else{if(Lightbox.contentType==="video"){Lightbox.setVideo(Lightbox.contents[Lightbox.currentIndex]);}else{if(Lightbox.contentType==="embed"){Lightbox.setEmbed(Lightbox.contents[Lightbox.currentIndex]);}}}}},previous:function(){var a=Lightbox.contents.length;if(a>1){Lightbox.currentIndex--;if(Lightbox.currentIndex<0){Lightbox.currentIndex=Lightbox.contents.length-1;}if(Lightbox.contentType==="image"){Lightbox.setImage(Lightbox.contents[Lightbox.currentIndex]);}else{if(Lightbox.contentType==="video"){Lightbox.setVideo(Lightbox.contents[Lightbox.currentIndex]);}else{if(Lightbox.contentType==="embed"){Lightbox.setEmbed(Lightbox.contents[Lightbox.currentIndex]);}}}}},flashEmbedCallback:function(a){if(!a.success){Lightbox.content.html(Flash.getFlashError());}}};